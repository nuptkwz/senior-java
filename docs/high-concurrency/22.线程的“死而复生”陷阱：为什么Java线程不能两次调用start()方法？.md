[toc]

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä½ ä»¬çš„æŠ€æœ¯è€å‹**ç§‘å¨èˆŸ**ï¼Œä»Šå¤©ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹ä¸ºä»€ä¹ˆJavaçº¿ç¨‹ä¸èƒ½ä¸¤æ¬¡è°ƒç”¨start()æ–¹æ³•ï¼Ÿ


> ä»Šå¤©ï¼Œæˆ‘ä»¬æ¥èŠèŠä¸€ä¸ªçœ‹ä¼¼ç®€å•å´æš—è—ç„æœºçš„é¢è¯•å¿…è€ƒé¢˜ï¼šçº¿ç¨‹é‡å¯ä¹‹è°œã€‚

åœ¨ä¸€æ¬¡é¢è¯•ä¸­ï¼Œä¸€ä½æ±‚èŒè€…è¢«é—®åˆ°ï¼šâ€œå¦‚æœåŒä¸€ä¸ªçº¿ç¨‹ä¸¤æ¬¡è°ƒç”¨start()æ–¹æ³•ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿâ€ä»–è‡ªä¿¡æ»¡æ»¡åœ°å›ç­”ï¼šâ€œå½“ç„¶ä¼šå†æ¬¡æ‰§è¡Œå•Šï¼â€ç»“æœå¯æƒ³è€ŒçŸ¥ã€‚è¿™ä¸ªé—®é¢˜çœ‹ä¼¼ç®€å•ï¼Œå´éš¾å€’äº†æ— æ•°Javaåˆå­¦è€…ã€‚

ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥æ·±å…¥å‰–æè¿™ä¸ªçœ‹ä¼¼ç®€å•å´æš—è—ç„æœºçš„æŠ€æœ¯é—®é¢˜ã€‚

## ä¸€ã€ä¸€ä¸ªç®€å•çš„å®éªŒï¼šçº¿ç¨‹çš„â€œæ­»è€Œå¤ç”Ÿâ€å°è¯•

å…ˆæ¥çœ‹ä¸€æ®µç®€å•çš„ä»£ç ç¤ºä¾‹ï¼š

```java
public class ThreadRestartDemo {
    public static void main(String[] args) {
        Thread thread = new Thread(() -> {
            System.out.println("çº¿ç¨‹æ‰§è¡Œä¸­...");
        });
        
        thread.start(); // ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œæ­£å¸¸æ‰§è¡Œ âœ…
        
        // ç­‰å¾…ä¸€æ®µæ—¶é—´è®©çº¿ç¨‹æ‰§è¡Œå®Œæ¯•
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        
        thread.start(); // ç¬¬äºŒæ¬¡è°ƒç”¨ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ ğŸ’¥
    }
}
```

è¿è¡Œç»“æœå¦‚ä¸‹ï¼š

```
çº¿ç¨‹æ‰§è¡Œä¸­...
Exception in thread "main" java.lang.IllegalThreadStateException
```

å¾ˆæ˜æ˜¾ï¼Œ**ç¬¬äºŒæ¬¡è°ƒç”¨start()æ–¹æ³•æ—¶æŠ›å‡ºäº†IllegalThreadStateExceptionå¼‚å¸¸**ï¼Œè¿™æ„å‘³ç€çº¿ç¨‹çŠ¶æ€ä¸åˆæ³•ã€‚

## äºŒã€ä¸ºä»€ä¹ˆä¸èƒ½ä¸¤æ¬¡è°ƒç”¨start()ï¼Ÿæ·±å…¥æºç ä¸€æ¢ç©¶ç«Ÿ

è¦ç†è§£è¿™ä¸ªé—®é¢˜çš„æ ¹æºï¼Œæˆ‘ä»¬éœ€è¦æ·±å…¥Threadç±»çš„start()æ–¹æ³•æºç ï¼š

```java
public synchronized void start() {
    if (threadStatus != 0)  // å…³é”®æ£€æŸ¥ï¼
        throw new IllegalThreadStateException();
    
    group.add(this);
    boolean started = false;
    try {
        start0();  // è°ƒç”¨æœ¬åœ°æ–¹æ³•å¯åŠ¨çº¿ç¨‹
        started = true;
    } finally {
        if (!started) {
            group.threadStartFailed(this);
        }
    }
}
```

åœ¨start()æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªæ£€æŸ¥å°±æ˜¯åˆ¤æ–­`threadStatus != 0`ã€‚å¦‚æœè¿™ä¸ªæ¡ä»¶æˆç«‹ï¼Œå°±ä¼šç«‹å³æŠ›å‡ºIllegalThreadStateExceptionå¼‚å¸¸ã€‚

**é‚£ä¹ˆthreadStatusæ˜¯ä»€ä¹ˆï¼Ÿ** å®ƒæ˜¯Threadç±»ä¸­ä¸€ä¸ªç”¨äºè®°å½•çº¿ç¨‹çŠ¶æ€çš„å˜é‡ã€‚å½“çº¿ç¨‹åˆšè¢«åˆ›å»ºï¼ˆNEWçŠ¶æ€ï¼‰æ—¶ï¼ŒthreadStatusçš„å€¼ä¸º0ã€‚ä¸€æ—¦çº¿ç¨‹è¢«å¯åŠ¨ï¼Œå®ƒçš„çŠ¶æ€å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¸å†ä¸º0ã€‚

å¯ä»¥æŠŠçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæ¯”ä½œä¸€ä¸ªäººçš„ä¸€ç”Ÿï¼š

- **NEWï¼ˆæ–°å»ºï¼‰** ï¼šå©´å„¿å‡ºç”Ÿï¼Œå‡†å¤‡å¥½äº†ä½†è¿˜æ²¡å¼€å§‹ç”Ÿæ´»
- **RUNNABLEï¼ˆå¯è¿è¡Œï¼‰** ï¼šé•¿å¤§æˆäººï¼Œå¼€å§‹å·¥ä½œå’Œç”Ÿæ´»
- **TERMINATEDï¼ˆç»ˆæ­¢ï¼‰** ï¼šç”Ÿå‘½ç»“æŸï¼Œæ— æ³•å¤æ´»

å°±åƒäººæ­»ä¸èƒ½å¤ç”Ÿä¸€æ ·ï¼Œ**çº¿ç¨‹ä¸€æ—¦æ‰§è¡Œå®Œæ¯•ï¼Œå°±è¿›å…¥äº†TERMINATEDçŠ¶æ€ï¼Œæ— æ³•å†æ¬¡å¯åŠ¨**ã€‚

## ä¸‰ã€åº•å±‚åŸç†ï¼šçº¿ç¨‹çš„å¯åŠ¨è¿‡ç¨‹åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

å½“æˆ‘ä»¬è°ƒç”¨start()æ–¹æ³•æ—¶ï¼Œåº•å±‚åˆ°åº•ç»å†äº†å“ªäº›è¿‡ç¨‹ï¼Ÿè®©æˆ‘ä»¬ç»§ç»­æ·±å…¥ï¼š

### 1. çº¿ç¨‹çŠ¶æ€æ£€æŸ¥

é¦–å…ˆï¼Œstart()æ–¹æ³•ä¼šæ£€æŸ¥çº¿ç¨‹çŠ¶æ€ã€‚åªæœ‰åœ¨NEWçŠ¶æ€ä¸‹çš„çº¿ç¨‹æ‰èƒ½è¢«å¯åŠ¨ã€‚

### 2. åŠ å…¥çº¿ç¨‹ç»„

é€šè¿‡group.add(this)å°†çº¿ç¨‹æ·»åŠ åˆ°çº¿ç¨‹ç»„ä¸­ã€‚

### 3. è°ƒç”¨æœ¬åœ°æ–¹æ³•start0()

è¿™æ˜¯æœ€å…³é”®çš„æ­¥éª¤ï¼Œstart0()æ˜¯ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œç”±JVMé€šè¿‡C/C++ä»£ç å®ç°ã€‚å®ƒçš„ä¸»è¦å·¥ä½œåŒ…æ‹¬ï¼š

- **è°ƒç”¨æ“ä½œç³»ç»ŸAPIåˆ›å»ºåŸç”Ÿçº¿ç¨‹**ï¼ˆLinuxä¸‹æ˜¯pthread_createï¼ŒWindowsä¸‹æ˜¯_beginthreadexï¼‰
- **ä¸ºçº¿ç¨‹åˆ†é…æ ˆå†…å­˜ç©ºé—´**ï¼ˆå¤§å°ç”±-Xsså‚æ•°æ§åˆ¶ï¼‰
- **å°†æ–°çº¿ç¨‹äº¤ç»™æ“ä½œç³»ç»Ÿè°ƒåº¦**ï¼Œç­‰å¾…CPUæ—¶é—´ç‰‡æ‰§è¡Œrun()æ–¹æ³•

**çº¿ç¨‹æ ˆå†…å­˜æ— æ³•é‡å¤åˆå§‹åŒ–**ï¼Œè¿™æ˜¯ä¸èƒ½ä¸¤æ¬¡è°ƒç”¨start()çš„æ ¹æœ¬åŸå› ä¹‹ä¸€ã€‚ä¸€æ—¦çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œå¯¹åº”çš„æ ˆå†…å­˜å°±è¢«å›æ”¶äº†ï¼Œæ— æ³•å†æ¬¡ä½¿ç”¨ã€‚

## å››ã€å®æˆ˜åœºæ™¯ï¼šè¿™äº›æƒ…å†µä½ é‡åˆ°è¿‡å—ï¼Ÿ

### åœºæ™¯ä¸€ï¼šç®€å•çš„é‡å¤å¯åŠ¨é”™è¯¯

è¿™æ˜¯æœ€ç®€å•çš„åœºæ™¯ï¼Œä¹Ÿæ˜¯æ–°æ‰‹æœ€å®¹æ˜“çŠ¯çš„é”™è¯¯ï¼š

```java
public class SimpleRestartError {
    public static void main(String[] args) {
        Thread thread = new Thread(() -> {
            System.out.println("ä»»åŠ¡æ‰§è¡Œä¸­");
        });
        
        thread.start();
        
        // æŸäº›æƒ…å†µä¸‹ï¼Œç¨‹åºå‘˜å¯èƒ½è¯¯ä»¥ä¸ºå¯ä»¥å†æ¬¡å¯åŠ¨
        if (/* æŸäº›æ¡ä»¶ */ true) {
            thread.start(); // æŠ›å‡ºå¼‚å¸¸ï¼
        }
    }
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼šéœ€è¦é‡æ–°æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œåˆ›å»ºæ–°çš„çº¿ç¨‹å®ä¾‹ã€‚

### åœºæ™¯äºŒï¼šå¾ªç¯ä¸­è¯¯ç”¨çº¿ç¨‹å¯¹è±¡

```java
public class LoopThreadError {
    public static void main(String[] args) {
        Thread worker = new Thread(() -> {
            System.out.println("å¤„ç†ä»»åŠ¡");
        });
        
        for (int i = 0; i < 5; i++) {
            worker.start(); // ç¬¬ä¸€æ¬¡æ­£å¸¸ï¼Œåé¢æ¯æ¬¡éƒ½æŠ›å¼‚å¸¸
            // é”™è¯¯ï¼šæ„å›¾è®©çº¿ç¨‹æ‰§è¡Œ5æ¬¡ï¼Œå®é™…ä¸å¯è¡Œ
        }
    }
}
```

**è§£å†³æ–¹æ¡ˆ**ï¼šåº”è¯¥åœ¨å¾ªç¯å†…éƒ¨åˆ›å»ºçº¿ç¨‹ï¼Œæˆ–ä½¿ç”¨çº¿ç¨‹æ± ã€‚

### åœºæ™¯ä¸‰ï¼šå¼‚å¸¸å¤„ç†ä¸­ä¸å°å¿ƒé‡å¯çº¿ç¨‹

```java
public class ExceptionHandlerError {
    public static void main(String[] args) {
        Thread worker = new Thread(() -> {
            try {
                // æŸäº›å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ“ä½œ
                riskyOperation();
            } catch (Exception e) {
                // é”™è¯¯ï¼šåœ¨å¼‚å¸¸å¤„ç†ä¸­å°è¯•é‡æ–°å¯åŠ¨çº¿ç¨‹
                restartThread(); 
            }
        });
        
        worker.start();
    }
    
    private static void restartThread() {
        // é”™è¯¯å®ç°
        Thread currentThread = Thread.currentThread();
        // æ— æ³•é‡æ–°å¯åŠ¨éNEWçŠ¶æ€çš„çº¿ç¨‹
    }
}
```

## äº”ã€æ­£ç¡®æ–¹æ¡ˆï¼šå¦‚ä½•ä¼˜é›…åœ°å®ç°"é‡å¯"æ•ˆæœï¼Ÿ

æ—¢ç„¶çº¿ç¨‹ä¸èƒ½ä¸¤æ¬¡è°ƒç”¨start()ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°éœ€è¦é‡å¤æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸‰ç§æ–¹æ¡ˆï¼š

### æ–¹æ¡ˆä¸€ï¼šåˆ›å»ºæ–°çš„çº¿ç¨‹å®ä¾‹ï¼ˆæ¨èï¼‰

```java
public class NewThreadSolution {
    public static void main(String[] args) {
        Runnable task = () -> {
            System.out.println("æ‰§è¡Œä»»åŠ¡");
        };
        
        // æ¯æ¬¡éœ€è¦æ‰§è¡Œæ—¶åˆ›å»ºæ–°çº¿ç¨‹
        Thread thread1 = new Thread(task);
        thread1.start();
        
        // éœ€è¦å†æ¬¡æ‰§è¡Œæ—¶
        Thread thread2 = new Thread(task); // é‡æ–°åˆ›å»º
        thread2.start();
    }
}
```

è¿™ç§æ–¹æ³•ç®€å•ç›´æ¥ï¼Œé€‚ç”¨äºæ‰§è¡Œæ¬¡æ•°ä¸å¤šçš„åœºæ™¯ã€‚

### æ–¹æ¡ˆäºŒï¼šä½¿ç”¨çº¿ç¨‹æ± ï¼ˆæœ€ä½³å®è·µï¼‰

```java
public class ThreadPoolSolution {
    public static void main(String[] args) {
        ExecutorService executor = Executors.newCachedThreadPool();
        Runnable task = () -> {
            System.out.println("æ‰§è¡Œä»»åŠ¡");
        };
        
        // å¯ä»¥å¤šæ¬¡æäº¤ä»»åŠ¡
        executor.submit(task);
        executor.submit(task);
        executor.submit(task);
        
        executor.shutdown();
    }
}
```

**çº¿ç¨‹æ± æ˜¯ç”Ÿäº§ç¯å¢ƒä¸­çš„æœ€ä½³é€‰æ‹©**ï¼Œå®ƒå¯ä»¥å¤ç”¨çº¿ç¨‹ï¼Œé¿å…é¢‘ç¹åˆ›å»ºé”€æ¯çš„å¼€é”€ã€‚

### æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨Runnableé…åˆå¾ªç¯ï¼ˆç‰¹æ®Šåœºæ™¯ï¼‰

```java
public class RunnableLoopSolution implements Runnable {
    private volatile boolean running = true;
    
    @Override
    public void run() {
        while (running) {
            // æ‰§è¡Œä»»åŠ¡
            System.out.println("æ‰§è¡Œä»»åŠ¡");
            
            // ä»»åŠ¡é—´éš”
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
                break;
            }
        }
    }
    
    public void stop() {
        running = false;
    }
}
```

è¿™ç§æ–¹æ³•å…è®¸çº¿ç¨‹å†…éƒ¨å¾ªç¯æ‰§è¡Œä»»åŠ¡ï¼Œæ— éœ€å¤šæ¬¡å¯åŠ¨ã€‚

## å…­ã€é«˜é¢‘é¢è¯•é¢˜æ·±åº¦è§£æ

### Q1ï¼šä¸ºä»€ä¹ˆJavaè®¾è®¡æˆä¸èƒ½é‡å¤è°ƒç”¨start()ï¼Ÿ

**ç­”æ¡ˆ**ï¼šä¸»è¦åŸå› æœ‰ä¸‰ç‚¹ï¼š

1. **çº¿ç¨‹æ ˆå†…å­˜æ— æ³•é‡å¤åˆå§‹åŒ–**ï¼šçº¿ç¨‹æ‰§è¡Œå®Œæ¯•åï¼Œå¯¹åº”çš„æ ˆå†…å­˜å·²è¢«å›æ”¶
2. **ä¿è¯ç”Ÿå‘½å‘¨æœŸæ˜ç¡®æ€§**ï¼šæ˜ç¡®çš„çŠ¶æ€æµè½¬æœ‰åˆ©äºè°ƒè¯•å’Œé—®é¢˜æ’æŸ¥
3. **é¿å…ä¸å¯é¢„æœŸçš„å¹¶å‘é—®é¢˜**ï¼šå¦‚æœçº¿ç¨‹å¯é‡å¯ï¼Œå¯èƒ½å¯¼è‡´èµ„æºç«äº‰ã€æ•°æ®ä¸ä¸€è‡´ç­‰é—®é¢˜

### Q2ï¼šrun()æ–¹æ³•å¯ä»¥å¤šæ¬¡è°ƒç”¨å—ï¼Ÿ

```java
Thread thread = new Thread(() -> System.out.println("æ‰§è¡Œ"));
thread.run(); // âœ… å¯ä»¥
thread.run(); // âœ… å¯ä»¥ï¼Œä½†è¿™åªæ˜¯æ™®é€šæ–¹æ³•è°ƒç”¨
```

**ç­”æ¡ˆ**ï¼šå¯ä»¥ã€‚run()æ–¹æ³•åªæ˜¯ä¸€ä¸ªæ™®é€šæ–¹æ³•ï¼Œå¤šæ¬¡è°ƒç”¨ä¸ä¼šåˆ›å»ºæ–°çº¿ç¨‹ã€‚

### Q3ï¼šå¦‚ä½•åˆ¤æ–­çº¿ç¨‹æ˜¯å¦å·²å¯åŠ¨ï¼Ÿ

```java
Thread thread = new Thread(/* ... */);
// ä¸èƒ½ç›´æ¥è·å–threadStatusï¼Œå®ƒæ˜¯privateçš„

// å¯ä»¥é€šè¿‡çŠ¶æ€åˆ¤æ–­
if (thread.getState() == Thread.State.NEW) {
    thread.start(); // åªæœ‰NEWçŠ¶æ€çš„çº¿ç¨‹å¯ä»¥å¯åŠ¨
}
```

## ä¸ƒã€æ€»ç»“

Javaçº¿ç¨‹ä¸èƒ½ä¸¤æ¬¡è°ƒç”¨start()æ–¹æ³•ï¼Œè¿™**ä¸æ˜¯é™åˆ¶ï¼Œè€Œæ˜¯ä¿æŠ¤**ã€‚å®ƒä¿è¯äº†çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸçš„æ¸…æ™°å’Œå¯é¢„æµ‹æ€§ï¼Œé¿å…äº†æ½œåœ¨çš„å¹¶å‘é—®é¢˜ã€‚

**çº¿ç¨‹ä½¿ç”¨é»„é‡‘æ³•åˆ™**ï¼š
- æ–°å»ºçº¿ç¨‹å¦‚å‡ºç”Ÿ
- startä¸€æ¬¡å³äººç”Ÿ
- æ­»äº¡ä¹‹åéš¾å¤æ´»
- æƒ³è¦é‡ç”¨æ–°å»ºäºº

è®°ä½ï¼Œ**start()æ–¹æ³•å°±åƒäººç”Ÿçš„èµ·ç‚¹ï¼Œæ¯ä¸ªäººåªèƒ½å‡ºç”Ÿä¸€æ¬¡ï¼Œä½†å¯ä»¥é€šè¿‡åˆ›å»ºæ–°çº¿ç¨‹æˆ–ä½¿ç”¨çº¿ç¨‹æ± æ¥é‡ç”Ÿ**ã€‚

å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£Javaçº¿ç¨‹çš„å¯åŠ¨æœºåˆ¶ï¼Œé¿å…åœ¨å®é™…å¼€å‘ä¸­è¸©å‘ï¼

## å‚è€ƒèµ„æ–™

1. http://developer.aliyun.com/article/896772
2. https://juejin.cn/post/7461875587361194003
3. https://blog.csdn.net/qq_44378083/article/details/147683955
4. https://blog.csdn.net/dancheng1/article/details/81407886/
5. https://www.cnblogs.com/east7/p/14670750.html
6. https://m.php.cn/faq/460454.html
7. https://blog.csdn.net/weixin_61635597/article/details/128660034
8. https://juejin.cn/post/7491093307209465908

* æœ¬æ–‡ä¸»è¦è§‚ç‚¹åŸºäºä»¥ä¸Šå‚è€ƒèµ„æ–™ï¼Œç»“åˆå®é™…å¼€å‘ç»éªŒæ•´ç†è€Œæˆã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚*

---
æ›´å¤šæŠ€æœ¯å¹²è´§æ¬¢è¿å…³æ³¨å¾®ä¿¡å…¬ä¼—å·**ç§‘å¨èˆŸçš„AIç¬”è®°**~

![](https://files.mdnice.com/user/101007/5b1be244-b402-456b-bafb-63490ab66749.jpg)

ã€è½¬è½½é¡»çŸ¥ã€‘ï¼š**è½¬è½½è¯·æ³¨æ˜åŸæ–‡å‡ºå¤„åŠä½œè€…ä¿¡æ¯**

